## 기존 권한 변경하기 - 권한 통합 (Prebon, 환율 옵션)

### 작업 개요

- 최초 요청일: 2018-12-07
- 기존에 사용 중이던 권한 2종에 대해 각각 하위 권한 2개로 분리되어 있던 것을 1개로 

### 요청 원문
```
요청자: 이성훈  

To. 안지원 과장님,

  ㅇ개편요청서의 1단계만 확인해주면 되요. ('권한없음' 추가,   빨간색 으로 표기함)

  ㅇ현재 점검사항 중 반영안된 것으로 보이는 점 있는데 확인부탁해요.

     1)Tullet Prebon의 권한구분을 '종가'로 놓으면 '유무상구분'은 무조건 '무상'이 되어야함.
         →현재 개발에는 '금지표시'는 나오지만 '유상'으로 선택해도 저장이 됨
		 
		 
     2)개편요청서에 (Default)라고 되어 있는 것도 콤보리스트에 반영 부탁함
        → 非딜러:非딜러(Default) 로 .
            '종가' : '종가(Default)' 로.

 

To. 이용원 과장님,  

   2단계에 대한거 수정중이에요. 확정되면 재송부 할게요.  붉은색 으로 표기
```


### 작업 내용

2019-01-17
백엔드 이행 완료 후 옵션 데이터 일괄 변경 적용


2019-01-11
수정07 추가 요구사항

1. 채권고급형 권한 기보유 여부에 따른 Prebon 옵션 권한 부여
채권고급형: GOODS_OPTION_CD=6 , AUTO_NM='MENU' and OPT_NO=6

select g.GOODS_SQ, g.PID, o.GOODS_OPTION_CD, o.AUTHOR_SE_CD, o.CMGR_SE_CD
from
(select * from TN_GOODS_OPTIONS where GOODS_OPTION_CD=6) o left outer join
(select * from TN_GOODS where CNTRCT_STT_CD='001') g on o.GOODS_SQ=g.GOODS_SQ
where g.GOODS_SQ is not null;

2. 채권고급 설정에 따라 Prebon 옵션 권한은 기존 설정에서 예외가 되어 변경도 가능
"TR00000182","CPG1117001","CP43500017","CP20151118","TR00100502","TR81000002","RL00130004","RL00130001","CP22600011","CP22600010","CP22600009","CP22600008","CP20151116","CP20151115","CP20151114","CP81000001","TR00002201","CP52000010","CP52000007","CP52000001","CP52000006","CP52000004","CP47800001","CP44400001","CP44000002","CP44000001","CP43600001","CP43500011","TR00000410","CP43500016","CP43500015","CP43500014","CP43500013","CP43500012","CP43500010","CP43500001","CP22600003","CP22600002","CM01299903","CM01200001","CM01299902","CM01299901","TR00010185","PB05300001","CP38900001","PB00300201","MN91700001","MN01100101","MN92999901","MN91899903","MN91800001","MN91800002","TR00010507","RL00107801","RL00104802","RL00101910","RL10702102","RL10702101","RL00100804","RL10702003","RL00101906","RL00101911","RL10702001","RL00110001","RL00103301","RL00199915","RL10700101","RL00101913","RL10702002","RL10799901","RL00102201","RL00101909","RL00102502","RL00121001","RL10700005","RL10700003","RL10700002","RL00400201","RL00400108","RL00101102","RL00400102","RL00107901","RL00400101","RL00499901","RL00400106","RL00421302","RL00421304","RL00400104","RL00421303","RL00421301","RL00400501","RL00100404","RL00100401","RL00400110","RL00400105","RL00110005","RL00400107","RL00400112","RL00100101","RL00101103","RL00101203","RL00101206","RL00100803","RL00106001","RL00108101","RL00102401","RL00400116","RL00114511","RL00109701","RL00400115","RL00103501","RL00400117","RL00100502","RL00104004","RL00104005","RL00103001","RL00104006","RL00108001","RL00102501","RL00100807","RL00499902","RL00400203","RL00101105","RL00104804","RL00104803","RL00100801","RL00100802","RL00103101","RL00121103","RL00100901","RL00100201","RL00109201","RL00108201","RL00109001","RL00200901","RL00105001","RL00101101","RL00104601","RL00109401","RL00101802","RL00107001","RL00110010","RL00102301","RL00010051","RL00010050","RL00109802","RL00109803","RL00100301","RL00199907","RL10705001","RL00104401","RL00103302","RL00100110","RL00103401","RL00110003","RL00110008","RL00100102","RL00102001","RL00102101","RL00101905","RL00105301","RL00199917","RL00199916","RL00101912","CP08200002","CP08200001","PS00900003"

--====================================================================================================================================================
2018-12-04(화)

47 : 해외국채금리와 금리스왑 //권한없음, 종가, 실시간
48 : 삭제

51 : 달러-원 환율 (남김)
52 : 삭제


. 옵션 코드 수정 : COM072
해당 옵션 미사용 설정
남은 옵션 이름 변경


. 조회 화면 : TabbedGoodsOptionView
GoodsScrnController.java
옵션 목록 가져오는 방식 수정: 미사용 옵션은 가져오지 않음
Goods_SQL_mysql.xml <select id="goodsOptionList" ...></select>
USE_AT='Y'인 경우만 가져오기 (join 시에 적용)


. 수정 화면 : MngUpdateOptionPopup
  - 불필요한 선택지 숨기기

. 정상동작 여부 확인

/data/koscom/kc_crm/WEB-INF/classes/egovframework/sqlmap/kr/co/koscom/crm/Goods_SQL_mysql.xml
/data/koscom/kc_crm/WEB-INF/jsp/bos/crm/goods/MngUpdateOptionPopup.jsp/bos/crm/goods/MngUpdateOptionPopup
